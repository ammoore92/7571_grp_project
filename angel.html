<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
      integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
      crossorigin="anonymous"
    />
    <style>
      img {
        width: 75px;
        height: 100px;
      }
    </style>
    <title>Array Breakdown</title>
  </head>
  <body>
    <div class="container">
      <div class="row">
        <input type="button" id="go" value="Go" />
      </div>
      <hr />
      <div class="row">
        <div id="all"></div>
        <div id="explore"></div>
      </div>
      <hr />
      <div class="row">
        <div id="want"></div>
      </div>
      <hr />
      <div class="row">
        <div id="done"></div>
      </div>
    </div>
  </body>
  <script type="text/javascript">
    document.getElementById("go").addEventListener("click", loadBooks);

    var books = {
      b9780525536291: {
        bookCover: "https://s1.nyt.com/du/books/images/9780525536291.jpg",
        title: "The Vanishing Half",
        author: "Brit Bennett",
        isbn: "9780525536291",
        status: 0,
      },
      b9780316420044: {
        bookCover: "https://s1.nyt.com/du/books/images/9780316420044.jpg",
        title: "28 Summers",
        author: "Elin Hilderbrand",
        isbn: "9780316420044",
        status: 0,
      },
      b9780735219090: {
        bookCover: "https://s1.nyt.com/du/books/images/9780735219090.jpg",
        title: "Where the Crawdads Sing",
        author: "Delia Owens",
        isbn: "9780735219090",
        status: 1,
      },
      b9780385546270: {
        bookCover: "https://s1.nyt.com/du/books/images/9780385546270.jpg",
        title: "Sex and Vantity",
        author: "Kevin Kwan",
        isbn: "9780385546270",
        status: 2,
      },
    };

    function loadBooks() {
      allBooks();
    }

    function allBooks() {
      var allBooksTable = "";

      allBooksTable += "<h3>ALL</h3>";
      allBooksTable += "<br />";
      allBooksTable += "<table class='table'>";
      allBooksTable += "<thead>";
      allBooksTable += "<tr>";
      allBooksTable += "<th>Cover</th>";
      allBooksTable += "<th>Title</th>";
      allBooksTable += "<th>Author</th>";
      allBooksTable += "<th>Status</th>";
      allBooksTable += "<th>Completed</th>";
      allBooksTable += "</tr>";
      allBooksTable += "</thead>";
      allBooksTable += "<tbody>";

      Object.keys(books).forEach(function (key) {
        allBooksTable += "<tr>";
        allBooksTable += "<td><img src='" + books[key].bookCover + "'></td>";
        allBooksTable += "<td><i>" + books[key].title + "</i></td>";
        allBooksTable += "<td>" + books[key].author + "</td>";
        allBooksTable += "<td>" + books[key].status + "</td>";
        allBooksTable += "<td>";
        allBooksTable +=
          "<select id='b" +
          books[key].isbn +
          "' name='moveToWantList' class='bookDD'>";
        allBooksTable += "<option value='blank'></option>";
        allBooksTable += "<option value='want'>Want to Read</option>";
        allBooksTable += "<option value='read'>Read</option>";
        allBooksTable += "<option value='remove'>Remove</option>";
        allBooksTable += "</select>";
        allBooksTable += "</td>";
        allBooksTable += "</tr>";
      });

      allBooksTable += "</tbody>";
      allBooksTable += "</table>";
      allBooksTable += "<br/>";
      allBooksTable +=
        "<input type='button' id='update1' value='Move to Want'/>";

      document.getElementById("all").innerHTML = allBooksTable;

      document.getElementById("update1").addEventListener("click", moveBooks);
      document.getElementById("update1").addEventListener("click", wantBooks);
    }

    function wantBooks() {
      var wantBooksTable = "";

      wantBooksTable += "<h3>WANT</h3>";
      wantBooksTable += "<br />";
      wantBooksTable += "<table class='table'>";
      wantBooksTable += "<thead>";
      wantBooksTable += "<tr>";
      wantBooksTable += "<th>Cover</th>";
      wantBooksTable += "<th>Title</th>";
      wantBooksTable += "<th>Author</th>";
      wantBooksTable += "<th>Status</th>";
      wantBooksTable += "</tr>";
      wantBooksTable += "</thead>";
      wantBooksTable += "<tbody>";

      Object.keys(books).forEach(function (key) {
        if (books[key].status > 0) {
          wantBooksTable += "<tr>";
          wantBooksTable += "<td><img src='" + books[key].bookCover + "'></td>";
          wantBooksTable += "<td><i>" + books[key].title + "</i></td>";
          wantBooksTable += "<td>" + books[key].author + "</td>";
          wantBooksTable += "<td>" + books[key].status + "</td>";
          wantBooksTable += "</tr>";
        }
      });

      wantBooksTable += "</tbody>";
      wantBooksTable += "</table>";

      document.getElementById("want").innerHTML = wantBooksTable;
    }

    function doneBooks() {
      var doneBooksTable = "";

      doneBooksTable += "<h3>DONE</h3>";
      doneBooksTable += "<br />";
      doneBooksTable += "<table>";
      doneBooksTable += "<thead>";
      doneBooksTable += "<tr>";
      doneBooksTable += "<th>Cover</th>";
      doneBooksTable += "<th>Title</th>";
      doneBooksTable += "<th>Author</th>";
      doneBooksTable += "<th>Status</th>";
      doneBooksTable += "</tr>";
      doneBooksTable += "</thead>";
      doneBooksTable += "<tbody>";

      doneBooksTable += "</tbody>";
      doneBooksTable += "</table>";

      document.getElementById("done").innerHTML = doneBooksTable;
    }

    function moveBooks() {
      Object.keys(books).forEach(function (key) {
        //console.log(books[key]);
      });
      var bookKeys = Object.keys(books);
      //get the values from the dropdowns
      var elements = document.getElementsByClassName("bookDD");
      var elementNames = "";
      for (var a = 0; a < elements.length; a++) {
        elementNames += elements[a].id + "@" + elements[a].value + "@";
        elementNames += "*";
      }
      //split out the elements
      var elementArray = elementNames.split("*");
      //filter down the elements to the change needed; 1 = want, 2 = read, 3 = remove
      var elementArray1 = "";
      var elementArray2 = "";
      var elementArray3 = "";
      var elementArrayWant = "";
      var elementArrayRead = "";
      var elementArrayRemove = "";
      for (b = 0; b < elementArray.length; b++) {
        if (elementArray[b].includes("want")) {
          elementArray1 += elementArray[b];
        }
        if (elementArray[b].includes("read")) {
          elementArray2 += elementArray[b];
        }
        if (elementArray[b].includes("remove")) {
          elementArray3 += elementArray[b];
        }
      }
      var elementArrayWant = elementArray1.split("@");
      var elementArrayRead = elementArray2.split("@");
      var elementArrayRemove = elementArray3.split("@");
      //Remove status and blanks from the arrays
      for (var c = elementArrayWant.length - 1; c--; ) {
        if (elementArrayWant[c] === "want") elementArrayWant.splice(c, 1);
        if (elementArrayWant[c] === "") elementArrayWant.splice(c, 1);
      }
      for (var d = elementArrayRead.length - 1; d--; ) {
        if (elementArrayRead[d] === "read") elementArrayRead.splice(d, 1);
        if (elementArrayRead[d] === "read") elementArrayRead.splice(d, 1);
      }
      for (var e = elementArrayRead.length - 1; e--; ) {
        if (elementArrayRead[e] === "read") elementArrayRead.splice(e, 1);
        if (elementArrayRead[e] === "read") elementArrayRead.splice(e, 1);
      }

      //modify status

      console.log(elementArrayWant);
      console.log(bookKeys);

      for (f = 0; f < bookKeys.length; f++){
          if (bookKeys.includes(elementArrayWant) == true){
            //Object.keys(books).forEach(function (key) {}
            alert("match");
          }
      }


    }
  </script>
</html>
